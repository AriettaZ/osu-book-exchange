<!DOCTYPE html>
<html>
  <head>
    <title>MAGCProject6</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <%= stylesheet_link_tag    'dropzone/dropzone' %>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/css/bootstrap-select.min.css" />
      <!-- <%= javascript_include_tag  'dropzone.js' %> -->
  </head>

  <body>
    <!-- Custom flash messages -->
    <% flash.each do |message_type, message| %>
      <div style="color:red"><%= message %></div>
    <% end %>

    <p class="notice"><%= notice %></p>
    <p class="alert"><%= alert %></p>

    <%= render "shared/navigation", location: "top" %>
    <%= yield %>
    <%= source_helper %>
    <%= render "shared/footer" , location: "bottom"%>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/js/bootstrap-select.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
      $('.selectpicker').selectpicker();
      $(".carousel-inner div:first-child").first().addClass( "active" )
      $(".carousel-indicators li:first-child").first().addClass( "active" )
        $(".input-block-level").bind("keyup", function() {

          $(".input-block-level").addClass("loading"); // show the spinner
          // var form = $("#live-search-form"); // grab the form wrapping the search bar.

          var url = "https://www.googleapis.com/books/v1/volumes?" // live_search action.
          // alert(url)
          var formData ={}; // grab the data in the form
          formData['q']=$(".input-block-level").val()
          console.log(formData)
          $.get(url, formData, function(data){ // perform an AJAX get
            $(".input-block-level").removeClass("loading"); // hide the spinner
            $("#post_book_self_link").empty();
            $.each(data['items'], function( index, value ) {
           // $('#live-search-form').append($('<a href="#">'+value['volumeInfo']['title']);
              if (typeof value['volumeInfo']['industryIdentifiers'] != 'undefined'){
                $('#post_book_self_link').append($('<option value="'+ value['selfLink']+'" data-subtext="'+value['volumeInfo']['industryIdentifiers'][0]['type']+': '+value['volumeInfo']['industryIdentifiers'][0]['identifier']+'">'+value['volumeInfo']['title']+'</option>'));
                console.log( index + ": " + value['volumeInfo']['title'] );
              }
             });
           }).done(function(){
                 $('.selectpicker').selectpicker('refresh');
          });

      });
      });
  </script>
</html>
