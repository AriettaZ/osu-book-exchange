<% provide(title: "My Requests") %>
<h1>My Requests</h1>
<p>You have posted <%= @requests.length %> requests in total.</p>
<p>You can see all of your requests below.
</p>

<br>
<div id="req-btn-container" class="btn-group btn-group-toggle d-flex" role="group" aria-label="Request Buttons" data-toggle="buttons">
  <button id="ra-btn" class="btn btn-default w-100 active" style="padding:10px">Active Requests</button>
  <button id="rp-btn" class="btn btn-default w-100" style="padding:10px">Pending Requests</button>
  <button id="rc-btn" class="btn btn-default w-100" style="padding:10px">Closed Requests</button>
  <button id="rd-btn" class="btn btn-default w-100" style="padding:10px">Draft Requests</button>
</div>

<br>

<script>
$("document").ready(function(){
  // Create the basic call object
  var call_obj = {
    url: "",
    dataType: "html",
    method: "GET",
  }
  // Fill in the url based on button click
  $("#ra-btn").click(function(){
    call_obj.url = "ajax/a_request"
    // Get data from server and fill in current page
    $.ajax(call_obj).done(function(data){
      $("#main-content-req").html(data);
    });
    // Change button status
    $(this).addClass( "active" )
    $("#req-btn-container button").not(this).removeClass( "active" )
  });
  $("#rp-btn").click(function(){
    call_obj.url = "ajax/p_request"
    // Get data from server and fill in current page
    $.ajax(call_obj).done(function(data){
      $("#main-content-req").html(data);
    });
    // Change button status
    $(this).addClass( "active" )
    $("#req-btn-container button").not(this).removeClass( "active" )
  });
  $("#rc-btn").click(function(){
    call_obj.url = "ajax/c_request"
    // Get data from server and fill in current page
    $.ajax(call_obj).done(function(data){
      $("#main-content-req").html(data);
    });
    // Change button status
    $(this).addClass( "active" )
    $("#req-btn-container button").not(this).removeClass( "active" )
  });
  $("#rd-btn").click(function(){
    call_obj.url = "ajax/d_request"
    // Get data from server and fill in current page
    $.ajax(call_obj).done(function(data){
      $("#main-content-req").html(data);
    });
    // Change button status
    $(this).addClass( "active" )
    $("#req-btn-container button").not(this).removeClass( "active" )
  });

});
</script>



<div id="main-content-req">
  <!-- Initially loaded partial. -->
  <%=render partial: "ajax_pages/request", locals: {type: "active", table_name: "a-req-table"}%>
  <!-- AJAX will fill this with the correct table on button press-->
</div>
