<!-- <p id="notice"><%= notice %></p> -->
<% flash.each do |message_type, message| %>
  <% if message == "Bookmark Created"%>
    <div class="alert alert-success" role="alert"><%= message %></div>
  <% end %>
  <% if message == "Already Bookmarked"%>
    <div class="alert alert-warning" role="alert"><%= message %></div>
  <% end %>
<% end %>
<%= image_tag @post.book.cover_image unless @post.book.nil? %>
<div>Book: <%= @post.book.title unless @post.book.nil? %></div>
<div>Post Date: <%= distance_of_time_in_words(@post.created_at, Time.now) %> ago</div>
<% if @post.post_type=="offer" %>
<div>Seller: <%= User.find_by(id: @post.user_id).name %></div>
  <h2>More Information from Seller</h2>
<% else %>
<div>Buyer: <%= User.find_by(id: @post.user_id).name %></div>
  <h2>More Information from Buyer</h2>
<% end %>
<div>Course: <%= @post.course_number %></div>
<div>Price: <%= @post.price %></div>
<div>Type: <%= @post.post_type %></div>
<div>Payment Method: <%= @post.payment_method %>  <i class="fas fa-exclamation-circle">Learn more about payment method</i></div>
<div>condition: <%= @post.condition %></div>
<div>Description: <%= @post.description %></div>

<% if @images %>
<h2>Actual Product Pictures</h2>

<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    <% @images.each_with_index do |picture,index| %>
      <% puts index, picture.actual_product_image_url %>
      <li data-target="#carouselExampleIndicators" data-slide-to="<%= index %>"></li>
      <% end %>
  </ol>
  <div class="carousel-inner">
      <% @images.each_with_index do |picture , index| %>
        <% puts index, picture.actual_product_image_url %>
      <div class="carousel-item">
        <img class="d-block w-100" src="<%= picture.actual_product_image_url %>" alt="<%= index %> slide">
      </div>
    <% end %>
  </div>
  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
<% end %>

<% if current_user.is_a?(GuestUser) %>
  <% if @post.status == "active"|| @post.status == "pending"%>
    <%= link_to 'Contact Seller', new_user_session_path, class:['btn','btn-outline-primary'], role:['button']  %>
  <% end %>
  <% if @post.status == "active" %>
    <%= link_to 'Start a Contract',new_user_session_path , class:['btn','btn-outline-primary'], role:['button']%>
  <% end %>

  <%= link_to "Add Bookmark", new_user_session_path ,  class:['btn','btn-outline-primary'], role:['button'] %>

<% else %>
  <% if current_user.id!=@post.user_id %>
    <% if (@post.status == "active"|| @post.status == "pending")%>
      <%= link_to 'Contact Seller',  new_message_path(post_id: @post.id, talk_to: @post.user_id), class:['btn','btn-outline-primary'], role:['button']  %>
    <% end %>
    <% if @post.status == "active" && current_user.id!=@post.user_id %>
      <%= link_to 'Start a Contract', new_contract_path(post_id: @post.id, sender_id: current_user.id, receiver_id: @post.user_id), class:['btn','btn-outline-primary'], role:['button'] %>
    <% end %>
    <%= button_to "Add Bookmark", :controller => :bookmarks, :action => 'create', params: {post_id: @post.id}, :method => :post,class:['btn','btn-outline-primary']%>

  <% else  %>
    <% if @post.post_type=="offer" %>
      <%= link_to 'Edit', post_edit_offer_path(@post),  class:['btn','btn-outline-primary'], role:['button']  %>
    <% else %>
      <%= link_to 'Edit', post_edit_request_path(@post),  class:['btn','btn-outline-primary'], role:['button']  %>
    <% end %>
    <%= link_to 'Delete', @post, method: :delete, data: { confirm: 'Are you sure?' },class:['btn','btn-outline-primary'], role:['button']  %>
  <% end %>

<% end %>
<%= link_to 'Back', posts_path,  class:['btn','btn-outline-primary'], role:['button']  %>
</div>
<hr>
<script>
 $(".actual_product_image").each(function(){
        $(this).on('load', $(this).parent().attr("data-lightbox", "roadtrip"));
      })
</script>
